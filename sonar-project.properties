# SonarQube/SonarCloud Configuration for clang-tidy-automotive
# This file configures code quality analysis of the project itself

sonar.projectKey=montge_clang-tidy-automotive
sonar.projectName=Clang-Tidy Automotive
sonar.projectVersion=1.0.0

# Organization (for SonarCloud)
sonar.organization=montge

# Source code location
sonar.sources=src/automotive
sonar.sourceEncoding=UTF-8

# Exclude test files and LLVM symlinks from analysis
sonar.exclusions=**/test/**,**/llvm-project-*/**,**/*.md

# C++ specific settings
# Using compile_commands.json instead of build-wrapper-output
# sonar.cfamily.build-wrapper-output=build-wrapper-output
sonar.cfamily.threads=4

# Coverage report location (LCOV format from llvm-cov)
# Coverage requires full LLVM build with instrumentation (~15GB, ~2 hours).
# Generate locally with: ./scripts/coverage.sh
# Upload to SonarCloud with: ./scripts/upload-coverage-to-sonarcloud.sh
# Coverage file is committed to repo for CI analysis.
sonar.cfamily.llvm-cov.reportPath=coverage/coverage.lcov

# External issues from clang-tidy-automotive analysis
# sonar.externalIssuesReportPaths=sonarqube-issues.json

# Test file locations
# Note: sonar.test.inclusions is intentionally NOT set because:
# - Setting **/*.c,**/*.cpp globally would exclude source files from analysis
# - The sonar.tests=test path already limits test detection to the test directory
# - SonarCloud scans all C/C++ files under sonar.tests automatically
sonar.tests=test

# Quality gate settings
# The quality gate is configured in SonarCloud UI with these thresholds:
# - Coverage on new code: >= 80%
# - Duplicated lines on new code: <= 3%
# - Maintainability rating on new code: A
# - Reliability rating on new code: A
# - Security rating on new code: A
# - Security hotspots reviewed: 100%
#
# NOTE: Quality gate wait is disabled because coverage requires a full LLVM
# rebuild with instrumentation, which is resource-intensive and done manually
# via the coverage workflow. The quality gate status is still visible in
# SonarCloud dashboard. To generate coverage, run the coverage.yml workflow.
sonar.qualitygate.wait=false

# New code definition (for PR analysis)
# Reference branch is set dynamically in GitHub Actions workflow for gitflow:
#   - feature/* branches use develop as reference
#   - release/* and hotfix/* branches use main as reference
#   - develop branch uses main as reference
# sonar.newCode.referenceBranch is passed via -D in CI workflow

# SCM settings
sonar.scm.provider=git

# Duplicate detection
sonar.cpd.exclusions=**/test/**

# Issue management
sonar.issue.ignore.multicriteria=e1
sonar.issue.ignore.multicriteria.e1.ruleKey=cpp:S995
sonar.issue.ignore.multicriteria.e1.resourceKey=**/*.h
